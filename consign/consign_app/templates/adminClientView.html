{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <title>Datatables - Kaiadmin Bootstrap 5 Admin Dashboard</title>
    <meta
            content="width=device-width, initial-scale=1.0, shrink-to-fit=no"
            name="viewport"
    />
    <link
            rel="icon"
            href="{% static 'assets/img/kaiadmin/favicon.ico' %}"
            type="image/x-icon"
    />

    <!-- Fonts and icons -->
    <script src="{% static 'assets/js/plugin/webfont/webfont.min.js' %}"></script>
    <script>
        WebFont.load({
          google: { families: ["Public Sans:300,400,500,600,700"] },
          custom: {
            families: [
              "Font Awesome 5 Solid",
              "Font Awesome 5 Regular",
              "Font Awesome 5 Brands",
              "simple-line-icons",
            ],
            urls: ["{% static 'assets/css/fonts.min.css' %}"],
          },
          active: function () {
            sessionStorage.fonts = true;
          },
        });
    </script>

    <!-- CSS Files -->
    <link rel="stylesheet" href="{% static 'assets/css/bootstrap.min.css' %}"/>
    <link rel="stylesheet" href="{% static 'assets/css/plugins.min.css' %}"/>
    <link rel="stylesheet" href="{% static 'assets/css/kaiadmin.min.css' %}"/>

    <!-- CSS Just for demo purpose, don't include it in your project -->
    <link rel="stylesheet" href="{% static 'assets/css/demo.css' %}"/>
</head>
<body>
{% include 'index_menu.html' %}
<!-- End Navbar -->
</div>

<div class="container">
    <div class="page-inner">

        <script>
            // Function to set the default date to the current date
        function setCurrentDate() {
            var today = new Date();
            var day = today.getDate();
            var month = today.getMonth() + 1; // Months are zero-based
            var year = today.getFullYear();

            // Format date as YYYY-MM-DD
            var formattedDate = year + '-' + (month < 10 ? '0' + month : month) + '-' + (day < 10 ? '0' + day : day);

            // Set the value of the date input
            document.getElementById('fromdate').value = formattedDate;
            document.getElementById('todate').value = formattedDate;
        }

        // Run the function when the page loads
        window.onload = setCurrentDate;
        </script>

        <script>
            // Function to set the default date to the current date
       function setCurrentDate() {
           var today = new Date();
           var day = today.getDate();
           var month = today.getMonth() + 1; // Months are zero-based
           var year = today.getFullYear();

           // Format date as YYYY-MM-DD
           var formattedDate = year + '-' + (month < 10 ? '0' + month : month) + '-' + (day < 10 ? '0' + day : day);

           // Set the value of the date input
           document.getElementById('from_date').value = formattedDate;
           document.getElementById('to_date').value = formattedDate;
       }

       // Run the function when the page loads
       window.onload = setCurrentDate;
        </script>
        <form method="GET" action="{% url 'adminClientView' %}" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="row">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Client Information</div>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6 col-lg-4">
                                    <div class="form-group">
                                        <input type="text" name="search" value="{{ search_query }}"
                                               placeholder="Search..."
                                               style="padding: 8px; border: 1px solid #ddd; width: 300px;">
                                    </div>
                                </div>
                            </div>
                            <div class="card-action">
                                <button type="submit"
                                        style="padding: 8px; background-color: #4CAF50; color: white; border: none;">
                                    Search
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <h4 class="card-title">Information</h4>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table
                                    id="basic-datatables"
                                    class="display table table-striped table-hover"
                            >
                                <thead>
                                <tr style="background-color: #f2f2f2;">
                                    <th style="border: 1px solid #ddd; padding: 8px;">Client Name</th>
                                    <th style="border: 1px solid #ddd; padding: 8px;">Phone</th>
                                    <th style="border: 1px solid #ddd; padding: 8px;">Telephone</th>
                                    <th style="border: 1px solid #ddd; padding: 8px;">Email</th>
                                    <th style="border: 1px solid #ddd; padding: 8px;">Address</th>

                                    <th style="border: 1px solid #ddd; padding: 8px;">City</th>
                                    <th style="border: 1px solid #ddd; padding: 8px;">Pincode</th>
                                    <th style="border: 1px solid #ddd; padding: 8px;">GST</th>
                                    <th style="border: 1px solid #ddd; padding: 8px;">Pick UP Location</th>
                                    <th style="border: 1px solid #ddd; padding: 8px;">FOC</th>
                                    <th style="border: 1px solid #ddd; padding: 8px;">Client Type</th>
                                    <th style="border: 1px solid #ddd; padding: 8px;">TBB</th>
                                    <th style="border: 1px solid #ddd; padding: 8px;">Third part</th>
                                    <th style="border: 1px solid #ddd; padding: 8px;">Action</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for c in client %}
                                <tr>
    <td style="border: 1px solid #ddd; padding: 8px;">{{ c.name }}</td>
    <td style="border: 1px solid #ddd; padding: 8px;">{{ c.mobile }}</td>
    <td style="border: 1px solid #ddd; padding: 8px;">{{ c.telephone }}</td>
    <td style="border: 1px solid #ddd; padding: 8px;">{{ c.email }}</td>
    <td style="border: 1px solid #ddd; padding: 8px;">{{ c.address }}</td>
    <td style="border: 1px solid #ddd; padding: 8px;">{{ c.city }}</td>
    <td style="border: 1px solid #ddd; padding: 8px;">{{ c.pincode }}</td>
    <td style="border: 1px solid #ddd; padding: 8px;">{{ c.GST }}</td>
    <td style="border: 1px solid #ddd; padding: 8px;">{{ c.pickup }}</td>
    <td style="border: 1px solid #ddd; padding: 8px;">{{ c.foc }}</td>
    <td style="border: 1px solid #ddd; padding: 8px;">{{ c.clientType }}</td>
    <td style="border: 1px solid #ddd; padding: 8px;">{{ c.tbb }}</td>
    <td style="border: 1px solid #ddd; padding: 8px;">{{ c.thirdParty }}</td>
    <td style="border: 1px solid #ddd; padding: 8px;">
        <a href="{% url 'edit_client' c.id %}" class="btn btn-primary btn-sm">Edit</a>
    </td>
</tr>

                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

        </div>


    </div>
    <script>
        function showBranchDatalist() {
        const input = document.getElementById('t2');
        const datalist = document.getElementById('branch');

        if (input.value.length >= 2) {
            fetch(`/get_branch?query=${encodeURIComponent(input.value)}`)
                .then(response => response.json())
                .then(data => {
                    console.log('Fetched data:', data); // Debugging: Check the data in the console
                    datalist.innerHTML = ''; // Clear previous options

                    if (Array.isArray(data) && data.length > 0) {
                        data.forEach(number => {
                            const option = document.createElement('option');
                            option.value = number;
                            datalist.appendChild(option);
                        });
                    } else {
                        const option = document.createElement('option');
                        option.value = 'No results';
                        datalist.appendChild(option);
                    }
                })
                .catch(error => console.error('Error fetching vehicle numbers:', error));
        } else {
            datalist.innerHTML = ''; // Clear the datalist if fewer than 2 characters
        }
    }
    </script>
    <!-- End Custom template -->
</div>
<!--   Core JS Files   -->
<script src="{% static 'assets/js/core/jquery-3.7.1.min.js' %}"></script>
<script src="{% static 'assets/js/core/popper.min.js' %}"></script>
<script src="{% static 'assets/js/core/bootstrap.min.js' %}"></script>

<!-- jQuery Scrollbar -->
<script src="{% static 'assets/js/plugin/jquery-scrollbar/jquery.scrollbar.min.js' %}"></script>
<!-- Datatables -->
<script src="{% static 'assets/js/plugin/datatables/datatables.min.js' %}"></script>
<!-- Kaiadmin JS -->
<script src="{% static 'assets/js/kaiadmin.min.js' %}"></script>
<!-- Kaiadmin DEMO methods, don't include it in your project! -->
<script src="{% static 'assets/js/setting-demo2.js' %}"></script>

</body>
</html>
